

# תיקון מערכת אימות ספאם וקללות לכל נקודות ההזנה

## הבעיה
מערכת האימות (ספאם + קללות) פועלת רק כשמזינים פריטים דרך ה-textarea הראשי בלחיצת Enter. אבל יש מספר נקודות עקיפה:

1. **עריכה ישירה של פריט קיים** - כשעורכים טקסט של פריט שכבר ברשימה, אין שום בדיקה
2. **מעבר למצב קניות** - הפריטים עוברים כמו שהם ללא אימות מחדש
3. **קלט קולי (Voice)** - פריטים נוספים ללא בדיקה
4. **סריקת כתב יד (OCR/Handwriting)** - פריטים נוספים ללא בדיקה
5. **תבניות (Templates)** - פריטים נוספים ללא בדיקה

## הפתרון

### 1. אימות בעריכה ישירה של פריטים (ShoppingList.tsx)
בשני המקומות שמאפשרים עריכת טקסט של פריט קיים (תצוגת קטגוריות ותצוגה שטוחה), הוספת בדיקה ב-`onBlur` (כשהמשתמש יוצא מהשדה):
- הרצת `validateInput` ו-`containsProfanity`
- אם הטקסט לא תקין - החזרת הטקסט הקודם והצגת הודעת שגיאה
- שמירת הטקסט הקודם ב-ref לצורך שחזור

### 2. אימות במעבר למצב קניות (handleStartShopping)
לפני המרת notepadItems לפריטי קנייה - סינון פריטים לא תקינים עם הודעה למשתמש

### 3. אימות בקלט קולי, OCR וכתב יד
הוספת `validateInput` ו-`containsProfanity` לפני הוספת פריטים מקלט קולי, סריקה וכתב יד

### 4. אימות בתבניות
הוספת בדיקה גם לפריטים שמגיעים מתבניות (למרות שזה פחות סביר שם)

## פרטים טכניים

### קבצים שישתנו:
- **src/components/ShoppingList.tsx** - 6 נקודות תיקון:
  - שורות ~1433 ו-~1960: הוספת `onBlur` validation לשדות עריכה ישירה
  - שורות ~512-522: הוספת אימות ב-`handleStartShopping`
  - שורות ~1220-1224: אימות בקלט קולי
  - שורות ~1259-1263: אימות ב-OCR
  - שורות ~1299-1303: אימות בכתב יד
  - שורות ~643-648: אימות בתבניות

### לוגיקת האימות בעריכה ישירה:
```text
onChange -> מעדכן טקסט חופשי (חוויית כתיבה רגילה)
onBlur -> מריץ validateInput + containsProfanity
  אם לא תקין -> מחזיר לטקסט קודם + toast שגיאה
  אם תקין -> שומר
```

### לוגיקת האימות במעבר למצב קניות:
```text
handleStartShopping:
  לכל פריט -> validateInput + containsProfanity
  פריטים לא תקינים -> מוסרים עם toast אזהרה
  אם אין פריטים תקינים -> toast שגיאה ולא ממשיכים
```
